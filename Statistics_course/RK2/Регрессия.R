######################################################
# Prep RK
rm(list = ls())
alpha <- 0.01
qt(1-alpha/2, 37)
tb <- 0.15/sqrt(1-0.15^2) * sqrt(37)
x <- c(rep(20,4), rep(25,14), rep(30,46), rep(35,16), rep(40,20))
y <- c(rep(16,4), rep(16,6), rep(26,8), rep(26,10), rep(36,32), 
       rep(46,4), rep(36,3), rep(46,12), rep(56,1),rep(36,9), 
       rep(46,6),rep(56,5))
f <- matrix(c(rep(1,100), rep(20,4), rep(25,14), rep(30,46), 
              rep(35,16), rep(40,20)), ncol = 2)
f
length(y)
solve(t(f) %*% f) %*% t(f) %*% y

lm(y~x)
plot(x,y)




######################################################
######################################################
# Sem
ti <- 0:10
u <- c(100,75, 55, 40, 30, 20, 15,10,10,5,5)
lm(log(u)~ti)
plot(ti,log(u))

f <- matrix(c(1,1,1,1,1,1,1,1,1,1,1, -ti), ncol = 2)
ft_f <- t(f) %*% f

solve(ft_f) %*% t(f) %*% log(u)

bb <- solve(t(f) %*% f) %*% t(f) %*% log(u)

exp(4.613)

sum(ti)


######################################################
######################################################
# 