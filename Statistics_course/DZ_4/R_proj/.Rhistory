xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:1))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = c(0:k),seq(0.0, 1.0, 0.2))
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:1))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = c(0:k), ny = seq(0.0, 1.0, 0.2))
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:1))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k, ny = 1 / 0.2)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:1))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k, ny = 5)
dev.off()
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:1))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = NULL, ny = NULL)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,8),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:1))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = NULL, ny = NULL)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(0:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = NULL, ny = NULL)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = NULL, ny = NULL)
par(mar = c(4, 4, 2, 2), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k, ny = 1 / 0.2)
par(mar = c(4, 4, 2, 2), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
library(fitdistrplus)
theor_distr <- rbinom(n, k, p1)
png(filename = "../img/theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,9),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
dev.off()
png(filename = "../img/emp_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = F, axes = F,
xlim = c(0,8),
xlab = "Value", ylab = "CDF", main = "Emperical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
dev.off()
png(filename = "../img/emp_and_theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = T, axes = F,
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(theor_distr),
col = "black", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
legend("bottomright", c("Theoretical", "Emperical"),
lty=c(1,1),
fill=c("black", "red"))
dev.off()
library(fitdistrplus)
theor_distr <- rbinom(n, k, p1)
png(filename = "../img/theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
dev.off()
png(filename = "../img/emp_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1),
xlab = "Value", ylab = "CDF", main = "Emperical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
dev.off()
png(filename = "../img/emp_and_theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = T, axes = F,
xlim = c(0,k+1),
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(theor_distr),
col = "black", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
legend("bottomright", c("Theoretical", "Emperical"),
lty=c(1,1),
fill=c("black", "red"))
dev.off()
theor_distr <- rbinom(n, k, p1)
png(filename = "../img/theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
dev.off()
png(filename = "../img/emp_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Emperical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
dev.off()
png(filename = "../img/emp_and_theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = T, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(theor_distr),
col = "black", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.0, 0.2), las = 1)
grid(nx = k+1, ny = 1 / 0.2)
legend("bottomright", c("Theoretical", "Emperical"),
lty=c(1,1),
fill=c("black", "red"))
dev.off()
png(filename = "../img/theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
dev.off()
png(filename = "../img/emp_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Emperical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
dev.off()
png(filename = "../img/emp_and_theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = T, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(theor_distr),
col = "black", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
legend("bottomright", c("Theoretical", "Emperical"),
lty=c(1,1),
fill=c("black", "red"))
dev.off()
png(filename = "../img/theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
dev.off()
png(filename = "../img/emp_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Emperical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
dev.off()
png(filename = "../img/emp_and_theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = T, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(theor_distr),
col = "black", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
legend("bottomright", c("Theoretical", "Emperical"),
lty=c(1,1),
fill=c("black", "red"))
dev.off()
theor_distr_mean <- mean(theor_distr)
theor_distr_mean
emp_sample_mean <- mean(emp_sample)
emp_sample_mean
theor_distr_sd <- sd(theor_distr)
theor_distr_sd
emp_sample_sd <- sd(emp_sample)
emp_sample_sd
ks.test(cumsum(as.numeric(stat_series[3,]), pbinom(c(0:k), k, p1)))
cumsum(as.numeric(stat_series[3,])
ks.test(cumsum(as.numeric(stat_series[3,])), pbinom(c(0:k), k, p1)))
cumsum(as.numeric(stat_series[3,]))
ks.test(cumsum(as.numeric(stat_series[3,])), pbinom(c(0:k), k, p1))
ks.test(unique(cumsum(as.numeric(stat_series[3,]))), unique(pbinom(c(0:k), k, p1)))
library(xtable)
k <- 8
p1 <- 0.7
n <- 140
distr_series_table <- as.data.frame(rbind(c(0:k),
dbinom(c(0:k), k, p1)),
row.names = c("Random Value", "Probability"))
colnames(distr_series_table) <- c(0:k)
sum(distr_series_table[2,])
distr_series_table
distr_series_table <- rbind(distr_series_table,
cumsum(dbinom(c(0:k), k, p1)))
row.names(distr_series_table)[3] <- "Delta"
distr_series_table
sum(distr_series_table[2,])
distr_series_table <- rbind(distr_series_table)
set.seed(1337)
rand_unif <- runif(n, 0, 1)
head(rand_unif)
emp_sample <- ifelse(rand_unif < distr_series_table[3,1], 0,
ifelse(rand_unif < distr_series_table[3,2] & rand_unif >= distr_series_table[3,2-1], 1,
ifelse(rand_unif < distr_series_table[3,3] & rand_unif >= distr_series_table[3,3-1], 2,
ifelse(rand_unif < distr_series_table[3,4] & rand_unif >= distr_series_table[3,4-1], 3,
ifelse(rand_unif < distr_series_table[3,5] & rand_unif >= distr_series_table[3,5-1], 4,
ifelse(rand_unif < distr_series_table[3,6] & rand_unif >= distr_series_table[3,6-1], 5,
ifelse(rand_unif < distr_series_table[3,7] & rand_unif >= distr_series_table[3,7-1], 6,
ifelse(rand_unif < distr_series_table[3,8] & rand_unif >= distr_series_table[3,8-1], 7,
ifelse(rand_unif < distr_series_table[3,9] & rand_unif >= distr_series_table[3,9-1], 8,NA)))))))))
emp_sample
##
hist_tmp <- hist(emp_sample, breaks = c(0:k))
hist_tmp$counts
hist_tmp$breaks
stat_series <- as.data.frame(rbind(c(0:k),
c(0, hist_tmp$counts),
(c(0, hist_tmp$counts) / n) ),
row.names = c("Simulated values",
"Frequencies",
"Relative frequencies"))
colnames(stat_series) <- c(0:k)
library(fitdistrplus)
theor_distr <- rbinom(n, k, p1)
png(filename = "../img/theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(x = theor_distr),
col = "black", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
dev.off()
png(filename = "../img/emp_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = F, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Emperical CDF")
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
dev.off()
png(filename = "../img/emp_and_theor_ecdf.png",
width = 1920, height = 1080,
pointsize = 24, res = 96 * 1.25)
par(mar = c(4, 4, 2, 1), xaxs = "i", yaxs = "i")
plot(ecdf(emp_sample),
col = "red", lwd = 3, verticals = T, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(theor_distr),
col = "black", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
legend("bottomright", c("Theoretical", "Emperical"),
lty=c(1,1),
fill=c("black", "red"))
dev.off()
kolm_stat <- max(abs((cumsum(as.numeric(stat_series[3,])) - pbinom(c(0:k), k, p1))))
kolm_stat
theor_distr_mean <- mean(theor_distr)
theor_distr_mean
emp_sample_mean <- mean(emp_sample)
emp_sample_mean
theor_distr_sd <- sd(theor_distr)
theor_distr_sd
emp_sample_sd <- sd(emp_sample)
emp_sample_sd
install.packages("rootSolve")
library(rootSolve)
clt_ci_UP.0.1_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.1/2)
clt_ci_LP.0.1_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.1/2)
clt_ci_UP.0.1_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.1/2)
clt_ci_LB.01_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.1/2)
clt_ci_UB.01_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.1/2)
clt_ci_LB.005_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.05/2)
clt_ci_UB.005_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.05/2)
clt_ci_LB.002_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.02/2)
clt_ci_UB.002_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.02/2)
clt_ci_LB.01 <- uniroot(clt_ci_LB.01_foo, c(0.1, 0.9))$root
clt_ci_LB.01
clt_ci_UB.01 <- uniroot(clt_ci_UB.01_foo, c(0.1, 0.9))$root
clt_ci_LB.005 <- uniroot(clt_ci_LB.005_foo, c(0.1, 0.9))$root
clt_ci_UB.005 <- uniroot(clt_ci_UB.005_foo, c(0.1, 0.9))$root
clt_ci_LB.002 <- uniroot(clt_ci_LB.002_foo, c(0.1, 0.9))$root
clt_ci_UB.002 <- uniroot(clt_ci_UB.002_foo, c(0.1, 0.9))$root
compare_CI <- as.data.frame(matrix(c(clt_ci_LB.01, cp_ci_LB.01,
clt_ci_UB.01, cp_ci_UB.01,
clt_ci_LB.005, cp_ci_LB.005,
clt_ci_UB.005, cp_ci_UB.005,
clt_ci_LB.002, cp_ci_LB.002,
clt_ci_UB.002, cp_ci_UB.002), ncol = 2, byrow = T))
cp_ci_LB.01 <- qbeta(0.1/2, sum(emp_sample), n*k - sum(emp_sample) + 1)
cp_ci_LB.005 <- qbeta(0.05/2, sum(emp_sample), n*k - sum(emp_sample) + 1)
cp_ci_LB.002 <- qbeta(0.02/2, sum(emp_sample), n*k - sum(emp_sample) + 1)
cp_ci_UB.01 <- qbeta(1 - 0.1/2, sum(emp_sample) + 1, n*k - sum(emp_sample))
cp_ci_UB.005 <- qbeta(1 - 0.05/2, sum(emp_sample) + 1, n*k - sum(emp_sample))
cp_ci_UB.002 <- qbeta(1 - 0.02/2, sum(emp_sample) + 1, n*k - sum(emp_sample))
compare_CI <- as.data.frame(matrix(c(clt_ci_LB.01, cp_ci_LB.01,
clt_ci_UB.01, cp_ci_UB.01,
clt_ci_LB.005, cp_ci_LB.005,
clt_ci_UB.005, cp_ci_UB.005,
clt_ci_LB.002, cp_ci_LB.002,
clt_ci_UB.002, cp_ci_UB.002), ncol = 2, byrow = T))
compare_CI
k <- 8
p1 <- 0.7
n <- 140
distr_series_table <- as.data.frame(rbind(c(0:k),
dbinom(c(0:k), k, p1)),
row.names = c("Random Value", "Probability"))
colnames(distr_series_table) <- c(0:k)
sum(distr_series_table[2,])
distr_series_table
distr_series_table <- rbind(distr_series_table,
cumsum(dbinom(c(0:k), k, p1)))
row.names(distr_series_table)[3] <- "Delta"
distr_series_table
sum(distr_series_table[2,])
distr_series_table <- rbind(distr_series_table)
set.seed(1337)
rand_unif <- runif(n, 0, 1)
head(rand_unif)
emp_sample <- ifelse(rand_unif < distr_series_table[3,1], 0,
ifelse(rand_unif < distr_series_table[3,2] & rand_unif >= distr_series_table[3,2-1], 1,
ifelse(rand_unif < distr_series_table[3,3] & rand_unif >= distr_series_table[3,3-1], 2,
ifelse(rand_unif < distr_series_table[3,4] & rand_unif >= distr_series_table[3,4-1], 3,
ifelse(rand_unif < distr_series_table[3,5] & rand_unif >= distr_series_table[3,5-1], 4,
ifelse(rand_unif < distr_series_table[3,6] & rand_unif >= distr_series_table[3,6-1], 5,
ifelse(rand_unif < distr_series_table[3,7] & rand_unif >= distr_series_table[3,7-1], 6,
ifelse(rand_unif < distr_series_table[3,8] & rand_unif >= distr_series_table[3,8-1], 7,
ifelse(rand_unif < distr_series_table[3,9] & rand_unif >= distr_series_table[3,9-1], 8,NA)))))))))
emp_sample
##############################################################################
################################################################################
cp_ci_LB.01 <- qbeta(0.1/2, sum(emp_sample), n*k - sum(emp_sample) + 1)
cp_ci_LB.005 <- qbeta(0.05/2, sum(emp_sample), n*k - sum(emp_sample) + 1)
cp_ci_LB.002 <- qbeta(0.02/2, sum(emp_sample), n*k - sum(emp_sample) + 1)
cp_ci_UB.01 <- qbeta(1 - 0.1/2, sum(emp_sample) + 1, n*k - sum(emp_sample))
cp_ci_UB.005 <- qbeta(1 - 0.05/2, sum(emp_sample) + 1, n*k - sum(emp_sample))
cp_ci_UB.002 <- qbeta(1 - 0.02/2, sum(emp_sample) + 1, n*k - sum(emp_sample))
library(rootSolve)
clt_ci_LB.01_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.1/2)
clt_ci_UB.01_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.1/2)
clt_ci_LB.005_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.05/2)
clt_ci_UB.005_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.05/2)
clt_ci_LB.002_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) - qnorm(1-0.02/2)
clt_ci_UB.002_foo <- function(p) (sum(emp_sample) - n*k*p)/(sqrt(n*k*p*(1-p))) + qnorm(1-0.02/2)
clt_ci_LB.01 <- uniroot(clt_ci_LB.01_foo, c(0.1, 0.9))$root
clt_ci_UB.01 <- uniroot(clt_ci_UB.01_foo, c(0.1, 0.9))$root
clt_ci_LB.005 <- uniroot(clt_ci_LB.005_foo, c(0.1, 0.9))$root
clt_ci_UB.005 <- uniroot(clt_ci_UB.005_foo, c(0.1, 0.9))$root
clt_ci_LB.002 <- uniroot(clt_ci_LB.002_foo, c(0.1, 0.9))$root
clt_ci_UB.002 <- uniroot(clt_ci_UB.002_foo, c(0.1, 0.9))$root
compare_CI <- as.data.frame(matrix(c(clt_ci_LB.01, cp_ci_LB.01,
clt_ci_UB.01, cp_ci_UB.01,
clt_ci_LB.005, cp_ci_LB.005,
clt_ci_UB.005, cp_ci_UB.005,
clt_ci_LB.002, cp_ci_LB.002,
clt_ci_UB.002, cp_ci_UB.002), ncol = 2, byrow = T))
theor_distr <- rbinom(n, k, p1)
distr_UB <- rbinom(n, k, cp_ci_UB.01)
distr_LB <- rbinom(n, k, cp_ci_LB.01)
plot(ecdf(theor_distr),
col = "red", lwd = 3, verticals = T, axes = F,
xlim = c(0,k+1), ylim = c(0,1.2),
xlab = "Value", ylab = "CDF", main = "Theoretical and Emperical CDF")
plot(ecdf(distr_LB),
col = "black", lwd = 2, verticals = T, add = T)
plot(ecdf(distr_UB),
col = "blue", lwd = 2, verticals = T, add = T)
axis(1, c(1:k))
axis(2, seq(0.0, 1.2, 0.2), las = 1)
grid(nx = k+1, ny = 1.2 / 0.2)
legend("bottomright", c("Theoretical", "Lower", "Upper"),
lty=c(1,1,1),
fill=c("red", "black", "blue"))
compare_CI
